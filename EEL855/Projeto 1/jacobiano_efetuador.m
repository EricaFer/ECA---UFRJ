% Apontando para z
h1 = [0; 0; 1];
h3 = [0; 0; 1]; 
h5 = [0; 0; 1]; 
h7 = [0; 0; 1]; 

% Apontando para y
h2 = [0; 1; 0];
h4 = [0; 1; 0];
h6 = [0; 1; 0];

% vetor posição em relação à junta anterior
p01 = [0; 0; 0];
p12 = [0; 0; 0.1564 + 0.2104];
p23 = [0; 0; 0.2104 + 0.2104];
p34 = [0; 0; 0];
p45 = [0; 0; 0.2084 + 0.1059];
p56 = [0; 0; 0];
p67 = [0; 0; 0.1059 + 0.0615];

%ângulo das juntas na posição zero ("empinado")
q = [0 0 0 0 0 0 0];


%Matriz rotação 
R01 = [cos(q(1)) -sin(q(1)) 0; sin(q(1)) cos(q(1)) 0; 0 0 1];
R23 = [cos(q(3)) -sin(q(3)) 0; sin(q(3)) cos(q(3)) 0; 0 0 1];
R45 = [cos(q(5)) -sin(q(5)) 0; sin(q(5)) cos(q(5)) 0; 0 0 1];
R67 = [cos(q(7)) -sin(q(7)) 0; sin(q(7)) cos(q(7)) 0; 0 0 1];

R12 = [cos(q(2)) 0  sin(q(2));  0 1 0; -sin(q(2)) 0 cos(q(2))];
R34 = [cos(q(4)) 0  sin(q(4));  0 1 0; -sin(q(4)) 0 cos(q(4))];
R56 = [cos(q(6)) 0  sin(q(6));  0 1 0; -sin(q(6)) 0 cos(q(6))];

R02 = R01 * R12;
R03 = R01 * R12 * R23;
R04 = R01 * R12 * R23 * R34;
R05 = R01 * R12 * R23 * R34 * R45;
R06 = R01 * R12 * R23 * R34 * R45 * R56;
R07 = R01 * R12 * R23 * R34 * R45 * R56 * R67;

p45_0 = R04*p45;
p35_0 = R03*p34 + p45_0;
p25_0 = R02*p23 + p35_0;
p15_0 = R01*p12 + p25_0;

h_10 = (R01*h1);
h_20 = (R02*h2);
h_30 = (R03*h3);
h_40 = (R04*h4);
h_50 = (R05*h5);
h_60 = (R06*h6);
h_70 = (R07*h7);

h1_0 = [0 -h_10(3) h_10(2); h_10(3) 0 -h_10(1) ; -h_10(2) h_10(1) 0]; 
h2_0 = [0 -h_20(3) h_20(2); h_20(3) 0 -h_20(1) ; -h_20(2) h_20(1) 0]; 
h3_0 = [0 -h_30(3) h_30(2); h_30(3) 0 -h_30(1) ; -h_30(2) h_30(1) 0]; 
h4_0 = [0 -h_40(3) h_40(2); h_40(3) 0 -h_40(1) ; -h_40(2) h_40(1) 0]; 
h5_0 = [0 -h_50(3) h_50(2); h_50(3) 0 -h_50(1) ; -h_50(2) h_50(1) 0]; 
h6_0 = [0 -h_60(3) h_60(2); h_60(3) 0 -h_60(1) ; -h_60(2) h_60(1) 0]; 
h7_0 = [0 -h_70(3) h_70(2); h_70(3) 0 -h_70(1) ; -h_70(2) h_70(1) 0]; 

% Jacobiano de posição
J_5p= [h1_0*p15_0 h2_0*p25_0  h3_0*p35_0  h4_0*p45_0];

JE = [J5p zeros(3);
    h_10 h_20 h_30 h_40 h_50 h_60 h_70];

% vetor posição do Efetua
p5E_0 = R07 * p7e;


